<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>E-Y-E</title>
  <script type="module" src="./dist/e-y-e.min.js"></script>
  <style>
    #film_roll {
      width: 100%;
    }

    img {
      width: 100%;
      height: auto;
    }
  </style>
</head>
<body>
<e-y-e resize id="e_y_e" menu=true qr-code-reader=true></e-y-e>
<div id="film_roll"></div>
<script>
  const eyeElement = document.getElementById('e_y_e');
  const film_roll = document.getElementById('film_roll');

  eyeElement.addEventListener('NEW PICTURE', (e) => {
    const img = new Image();
    const img_data = URL.createObjectURL(e.detail);
    img.src = img_data;
    film_roll.prepend(img);
  });

  eyeElement.addEventListener('qr-code-scanned', (e) => {
    const qrData = e.detail.data;

    // Play sound
    const audio = new Audio('assets/qr-code-read.wav');
    audio.play();

    // Show dialog
    let dialog = document.querySelector('dialog');
    if (!dialog) {
      dialog = document.createElement('dialog');
      document.body.appendChild(dialog);
    }
    dialog.innerText = qrData;
    dialog.showModal();

    dialog.addEventListener('click', (event) => {
      if (event.target === dialog) {
        dialog.close();
      }
    });
  });
</script>
</body>
</html>